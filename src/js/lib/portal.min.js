!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.portal=e.portal||{})}(this,function(e){"use strict";function t(e,t,n){return n="undefined"!=typeof n?n:{withCredentials:!1},new Promise(function(i,o){var s=new XMLHttpRequest;s.withCredentials=n.withCredentials,s.addEventListener("readystatechange",function(){4===s.readyState&&200==s.status&&i(JSON.parse(s.responseText))}),s.addEventListener("error",function(){o(Error(s))}),s.open("GET",e+"?"+r(t)),s.send()})}function n(e,t,n){return n="undefined"!=typeof n?n:{withCredentials:!1},new Promise(function(i,o){var s=new XMLHttpRequest;s.withCredentials=n.withCredentials,s.addEventListener("readystatechange",function(){4===s.readyState&&200==s.status&&i(JSON.parse(s.responseText))}),s.addEventListener("error",function(){o(Error(s))}),s.open("POST",e),s.setRequestHeader("content-type","application/x-www-form-urlencoded"),s.send(r(t))})}function r(e,t){var n=[];for(var i in e)if(e.hasOwnProperty(i)){var o=t?t+"["+i+"]":i,s=e[i];n.push("object"==("undefined"==typeof s?"undefined":u(s))?r(s,o):encodeURIComponent(o)+"="+encodeURIComponent(s))}return n.join("&")}function i(e){var t=d.filter(function(t){return t.type===e})[0];return t="undefined"!=typeof t?t:{icon:"datafilesGray"}}function o(e){return new Promise(function(t){""===e?e="https://www.arcgis.com/":e.search("/home/")>0?e=e.substr(0,e.search("/home/"))+"/":e.search("/sharing/")>0?e=e.substr(0,e.search("/sharing/"))+"/":"/"!==e.charAt(e.length-1)&&(e+="/"),0===e.indexOf("http://")&&0===window.location.href.indexOf("https://")&&(e=e.replace("http://","https://")),t(e)})}function s(e){return 0===e.indexOf("http://")&&0===window.location.href.indexOf("https://")&&(e=e.replace("http://","https://")),e}function a(e){e="undefined"!=typeof e?e:{},this.portalUrl=e.portalUrl,this.username=e.username,this.token=e.token,this.withCredentials=!1,this.jsonp=!1,this.items=[],this.services=[],this.version=function(){var e=this,t=e.portalUrl+"sharing/rest",n={f:"json"},r={withCredentials:e.withCredentials};return f.get(t,n,r)},this.generateToken=function(e,t){var n=this,r=n.portalUrl+"sharing/rest/generateToken",i={client:"referer",referer:window.location.hostname,expiration:60,username:e,password:t,f:"json"},o={withCredentials:n.withCredentials};return f.post(r,i,o)},this.self=function(){var e=this,t=e.portalUrl+"sharing/rest/portals/self",n={token:e.token,f:"json"},r={withCredentials:e.withCredentials};return f.get(t,n,r)},this.search=function(e,t,n,r){var i=this,o=i.portalUrl+"sharing/rest/search",s={q:e,num:t,sortField:n,sortOrder:r,token:i.token,f:"json"},a={withCredentials:i.withCredentials};return f.get(o,s,a)},this.userProfile=function(e){var t=this,n=t.portalUrl+"sharing/rest/community/users/"+e,r={token:t.token,f:"json"},i={withCredentials:t.withCredentials};return f.get(n,r,i)},this.userContent=function(e,t){var n=this,r=n.portalUrl+"sharing/rest/content/users/"+e+"/"+t,i={token:n.token,f:"json"},o={withCredentials:n.withCredentials};return f.get(r,i,o)},this.itemDescription=function(e){var t=this,n=t.portalUrl+"sharing/rest/content/items/"+e,r={token:t.token,f:"json"},i={withCredentials:t.withCredentials};return f.get(n,r,i)},this.itemData=function(e){var t=this,n=t.portalUrl+"sharing/rest/content/items/"+e+"/data",r={token:t.token,f:"json"},i={withCredentials:t.withCredentials};return f.get(n,r,i)},this.addItem=function(e,t,n,r,i){var o=this,s=o.portalUrl+"sharing/rest/content/users/"+e+"/"+t+"/addItem",a=!0,l=!1,c=void 0;try{for(var u,d=n[Symbol.iterator]();!(a=(u=d.next()).done);a=!0){var p=h(u.value,2),y=p[0],w=p[1];null===w?n[y]="":w instanceof Array&&(n[y]=w.toString())}}catch(e){l=!0,c=e}finally{try{!a&&d.return&&d.return()}finally{if(l)throw c}}var v={item:n.title,text:JSON.stringify(r),overwrite:!1,thumbnailurl:i,token:o.token,f:"json"},m={withCredentials:o.withCredentials};return f.post(s,v,m)},this.updateWebmapData=function(e,t,n,r){var i=this,o=i.portalUrl+"sharing/rest/content/users/"+e+"/"+t+"/items/"+n+"/update",s={text:JSON.stringify(r),token:i.token,f:"json"},a={withCredentials:i.withCredentials};return f.post(o,s,a)},this.updateDescription=function(e,t,n,r){var i=this,o=i.portalUrl+"sharing/rest/content/users/"+e+"/"+n+"/items/"+t+"/update",s=!0,a=!1,l=void 0;try{for(var c,u=r[Symbol.iterator]();!(s=(c=u.next()).done);s=!0){var d=h(c.value,2),p=d[0],y=d[1];null===y?r[p]="":y instanceof Array&&(r[p]=y.toString())}}catch(e){a=!0,l=e}finally{try{!s&&u.return&&u.return()}finally{if(a)throw l}}var w=JSON.parse(r);w.token=i.token,w.f="json";var v={withCredentials:i.withCredentials};return f.post(o,w,v)},this.updateData=function(e,t,n,r){var i=this,o=i.portalUrl+"sharing/rest/content/users/"+e+"/"+n+"/items/"+t+"/update",s={text:r,token:i.token,f:"json"},a={withCredentials:i.withCredentials};return f.post(o,s,a)},this.updateUrl=function(e,t,n,r){var i=this,o=i.portalUrl+"sharing/rest/content/users/"+e+"/"+t+"/items/"+n+"/update",s={url:r,token:i.token,f:"json"},a={withCredentials:i.withCredentials};return f.post(o,s,a)},this.serviceDescription=function(e){var t=this,n=e,r={token:t.token,f:"json"},i={withCredentials:t.withCredentials};return f.get(n,r,i)},this.serviceLayers=function(e){var t=this,n=e+"/layers",r={token:t.token,f:"json"},i={withCredentials:t.withCredentials};return f.get(n,r,i)},this.layerRecordCount=function(e,t){var n=this,r=e+"/"+t+"/query",i={where:"1=1",returnCountOnly:!0,token:n.token,f:"json"},o={withCredentials:n.withCredentials};return f.get(r,i,o)},this.createService=function(e,t,n){var r=this,i=r.portalUrl+"sharing/rest/content/users/"+e+"/"+t+"/createService",o={createParameters:n,outputType:"featureService",token:r.token,f:"json"},s={withCredentials:r.withCredentials};return f.post(i,o,s)},this.addToServiceDefinition=function(e,t){var n=this;e=e.replace("/rest/services/","/rest/admin/services/");var r=e+"/addToDefinition",i={addToDefinition:t,token:n.token,f:"json"},o={withCredentials:n.withCredentials};return f.post(r,i,o)},this.checkServiceName=function(e,t,n){var r=this,i=r.portalUrl+"sharing/rest/portals/"+e+"/isServiceNameAvailable",o={name:t,type:n,token:r.token,f:"json"},s={withCredentials:r.withCredentials};return f.get(i,o,s)},this.harvestRecords=function(e,t,n,r){var i=this,o=e+"/"+t+"/query",s={where:"1=1",outFields:"*",returnGeometry:!0,resultOffset:n,resultRecordCount:r,token:i.token,f:"json"},a={withCredentials:i.withCredentials};return f.get(o,s,a)},this.addFeatures=function(e,t,n){var r=this,i=e+"/"+t+"/addFeatures",o={features:n,token:r.token,f:"json"},s={withCredentials:r.withCredentials};return f.post(i,o,s)},this.cacheItem=function(e){this.items.push({id:e.id,description:e})}}function l(e){return new a(e)}function c(e){return i(e)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},h=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&a.return&&a.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),f={get:t,post:n},d=[{type:"CityEngine Web Scene",icon:"webScene"},{type:"Color Set",icon:"datafilesGray"},{type:"Document Link",icon:"datafilesGray"},{type:"Image Service",icon:"imagery"},{type:"Feature Collection",icon:"features"},{type:"Feature Collection Template",icon:"maps"},{type:"Feature Layer",icon:"features"},{type:"Feature Service",icon:"features"},{type:"Geocoding Service",icon:"layers"},{type:"Geodata Service",icon:"layers"},{type:"Geometry Service",icon:"layers"},{type:"Geoprocessing Service",icon:"layers"},{type:"Globe Service",icon:"layers"},{type:"Network Analysis Service",icon:"layers"},{type:"Map Service",icon:"layers"},{type:"Mobile Application",icon:"apps"},{type:"Operation View",icon:"apps"},{type:"Scene Layer",icon:"sceneLayer"},{type:"Scene Service",icon:"sceneLayer"},{type:"Service Definition",icon:"datafiles"},{type:"Symbol Set",icon:"datafiles"},{type:"Web Map",icon:"maps"},{type:"Web Mapping Application",icon:"apps"},{type:"Web Scene",icon:"webScene"},{type:"WMS",icon:"layers"}],p={fix:function(e){return o(e)},upgrade:function(e){return s(e)}};e.Portal=a,e.portal=l,e.itemInfo=c,e.url=p,e.default=l,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=portal.min.js.map
